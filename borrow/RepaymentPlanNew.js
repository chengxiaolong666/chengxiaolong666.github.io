var nHaier=getQueryString("nHaier");var repayPrincipal=checkNumberVariable(getQueryString("repayPrincipal"));var lRepayDay=checkNumberVariable(getStringValue("lRepayDay"));var lProductId=getQueryString("BorrowId");$(function(){if(isVarComplete(repayPrincipal)){info("本金为空");return false}if(isVarComplete(lRepayDay)){info("还款日为空");return false}if(isVarComplete(lProductId)){info("借款产品id为空");return false}queryRepayplanData()});function queryRepayplanData(){var a=new CDO();a.setStringValue("strServiceName","BillService");a.setStringValue("strTransName","getRepayPlan");a.setLongValue("lAmount",repayPrincipal*100);a.setIntegerValue("nBillingDate",lRepayDay);a.setLongValue("lProductId",lProductId);raiseTrans(a,"callbackForRepayplanData")}function callbackForRepayplanData(c,f,b){if(!b){info("查询还款计划失败");return false}if(b.nCode!=0){info(b.strText);return false}var l=$("#dataShow");var k="";var e=f.getCDOArrayValue("cdosRepay");var j=f.getLongValue("lTotalPrincipal");var d=f.getLongValue("lTotalInterest");var a=f.getLongValue("lTotalHaierInterest");if(nHaier==1){for(var g=0,h=e.length;g<h;g++){var m="";$("#repayPlanTemplate li .schedule_name").html("还款日："+e[g].getStringValue("strRepayDate"));if(e[g].getLongValue("lPrincipal")!=0&&e[g].getLongValue("lHaierInterest")!=0){m+="本金："+e[g].getLongValue("lPrincipal")/100+"元<br>利息："+e[g].getLongValue("lHaierInterest")/100+"元<br>服务费："+e[g].getLongValue("lInterest")/100+"元"}else{m+="服务费："+e[g].getLongValue("lInterest")/100+"元"}$("#repayPlanTemplate li .schedule_money").html(m);if(g==h-1){$("#repayPlanTemplate li .schedule_name").css("padding-top:4%;")}k+=$("#repayPlanTemplate").html()}$("#repayServiceMoney").html((d/100).toFixed(2));$("#interest").html((a/100).toFixed(2));$("#serviceMoneyDiv").show()}else{for(var g=0,h=e.length;g<h;g++){$("#repayPlanTemplate li .schedule_name").html("还款日："+e[g].getStringValue("strRepayDate"));if(e[g].getLongValue("lPrincipal")!=0){$("#repayPlanTemplate li .schedule_money").html("本金："+e[g].getLongValue("lPrincipal")/100+"元<br>利息："+e[g].getLongValue("lInterest")/100+"元")}else{$("#repayPlanTemplate li .schedule_money").html("利息："+e[g].getLongValue("lInterest")/100+"元")}if(g==h-1){$("#repayPlanTemplate li .schedule_name").css("padding-top:2%;")}k+=$("#repayPlanTemplate").html()}$("#interest").html((d/100).toFixed(2))}$("#repayTotal").html((j/100+d/100+a/100).toFixed(2));$("#repayPrincipal").html(repayPrincipal);l.append(k)};