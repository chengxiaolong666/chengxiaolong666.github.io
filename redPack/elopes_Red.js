var lUserId=Number(getStringValue("lUserId"));var strLoginId=Number(getStringValue("strLoginId"));var encryptLid;var strPlatform=getChannelType();var payPassword="";$("#toReceive").click(function(){var a=getStringValue("strMobile");var b=new CDO();b.setStringValue("strServiceName","RedPacketDetailOperService");b.setStringValue("strTransName","addUserMoney");b.setLongValue("userId",Number(lUserId));b.setStringValue("mobile",a);raiseTrans(b,"callBackAddUserMoney")});function callBackAddUserMoney(b,c,a){if(a.nCode==0){openWindow("redPack/red_list_receive.htm","收到达赏列表","",0);document.getElementById("popup_red_b").style.display="none"}else{if(-5==a.nCode){_TTPopups.open2({content:"您未实名认证，请认证",cancelBtn:"否",submitBtn:"是",closeCallBack:"callBackTOIden"})}else{info(a.strText)}}}function callBackTOIden(a){if(1==a){openWindow("myCenter/securityCenter/accountIdCard.htm","实名认证","clearUser=1&nIdentityState=10",1)}}$("#toSend").click(function(){openWindow("redPack/red_list_send.htm","发放达赏列表","",0);document.getElementById("popup_red_b").style.display="none"});var flag=true;function createRedNPacket(){checkIsPayPwd("toCreateRedNPacket")}function toCreateRedNPacket(){try{var d=$("#totalRed").val();var i=$("#totalMony").val();var j=$("#message").val();if(d==""){info("您输入的达赏总数不正确!");return false}if(d<1||d>100){info("您输入的达赏总数不正确!");return false}if(!(/^[0-9]*[1-9][0-9]*$/.test(d))||d<0){info("达赏总数请输入1-100正整数!");return false}if(i==""){info("您输入的达赏总金额不正确!");return false}if(i<1||i>100){info("您输入的达赏总金额不正确!");return false}if(!(/^[0-9]*[1-9][0-9]*$/.test(i))||i<0){info("达赏总金额请输入1-100正整数!");return false}if(Number(d)>Number(i)){info("达赏总数不能大于达赏总金额！");return false}if(!flag){info("请勿重复提交");return false}flag=false;var i=$("#totalMony").val();i=(Number(i));var c="c_id01";var f="请输入支付密码";var b="达赏金额"+i+"元";var g="取消";var h="确定";openPayWindow(f,b,"","",false,"callbackFunctionOpenPayPasswordWindow")}catch(a){flag=true}}function callbackFunctionOpenPayPasswordWindow(b,a){if(a==0){flag=true;return}payNRed(b)}var payNRed=function(f){var b=$("#totalRed").val();var d=$("#totalMony").val();var c=$("#message").val();var a=f;if($.trim(a).length==6&&!isNaN(Number(a))){var e=new CDO();e.setStringValue("strServiceName","RedPackageNService");e.setStringValue("strTransName","createRedNPacket");e.setLongValue("lUserId",lUserId);e.setLongValue("strUserName",strLoginId);e.setLongValue("lRedAmount",d*100);e.setStringValue("nRedCount",b);e.setStringValue("strRedContent",c);e.setStringValue("strPayPassword",hex_md5(a+""));e.setStringValue("strPlatform",strPlatform);raiseTrans(e,"callBackForcreateRedNPacket")}else{flag=true;info("支付密码验证错误")}};function callBackForcreateRedNPacket(d,e,b){if(b.nCode==0){var a=$("#totalRed").val();var c=$("#totalMony").val();a=Number(a);c=Number(c);$("#reddass_red_text").html("已经将"+c+"元装入"+a+"个达赏");$("#reddass").show();$("#bred_overlayasd").show();document.ontouchmove=function(f){f.preventDefault()};encryptLid=e.getStringValue("url")}else{if(b.nCode==3){_TTPopups.open2({content:"账户余额不足,去充值",cancelBtn:"取消",submitBtn:"确定",closeCallBack:"toRecharge"})}else{info(b.strText)}}flag=true}function setMonyInfo(){$("#mound_money").html("0");var a=$("#totalMony").val();a=Number(a);if(a==""){info("达赏总金额输入不正确!");return false}if(a<1||a>100){info("达赏总金额输入不正确!");return false}if(!(/^[0-9]*[1-9][0-9]*$/.test(a))||a<0){info("达赏总金额请输入1-100正整数!");return false}$("#mound_money").html(a)}function shareRedPackage(){var a=$("#message").val();var c=$("#message").val();var b=1;EngineClass.shareInfo(a,c,b,encryptLid)}function toRecharge(){EngineClass.setStringValue("backURL","redPack/elopes_Red.htm");openWindow("myCenter/recharge/financial_recharge.htm","充值","",0)}$("#reddass_close").click(function(){$("#reddass").hide();$("#bred_overlayasd").hide();document.ontouchmove=function(a){};flag=true});