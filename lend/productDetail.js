var _obj={};_obj.muiFlag=false;_obj.rate=0;_obj.nDayUnit;_obj.nDayCount;_obj.balance=-1;_obj.xieyiVal=1;_obj.xutouVal=1;_obj.fixFlag=false;_obj.productName="";_obj.payType="";_obj.surplusAmount=-1;_obj.maxMoney=0;_obj.goPage=1;_obj.dealCode=-1;_obj.lProductId="-1";_obj.nProtocolState="";window.onload=function(){_shade_layer.show("加载中,请稍候......");_obj.productBackURL=getStringValue("productBackURL");setBackURL(_obj.productBackURL,"","",1,"","");_obj.lId=getStringValue("lId");_obj.lUserId=getStringValue("lUserId");_obj.loadProduct();setStringValue("productType","0")};_obj.loadProduct=function(){if(!_obj.lUserId){info("用户ID为空");return}if(!_obj.lId){info("系统错误!");return}var a=new CDO();a.setStringValue("strServiceName","LendProductService");a.setStringValue("strTransName","getDeptLendProductByIdForMobile");a.setLongValue("lId",Number(_obj.lId));raiseTrans(a,"callBackGeneratePage")};function callBackGeneratePage(s,v,e){if(_obj.ret(e,"获取详情失败")==false){return}if(e.nCode==0&&v.exists("cdoRecord")){var d=v.getCDOValue("cdoRecord");var w=Number(d.getStringValue("nLenderYearRate"));var b=Number(d.getStringValue("lMinInvestAmount"));b=Number(b/100).toFixed(0);var j=d.getStringValue("nDayUnit");var r=Number(d.getStringValue("nDayCount"));var h=j=="2"?"年":(j=="1"?"月":"天");var k=d.getStringValue("strLendModelCode");var q=Number(d.getStringValue("lPeriodAmount"));var f=d.getStringValue("nRecordCount")||0;q=(q/100).toFixed(0)||0;var l=d.getStringValue("strName");var i=(w/100).toFixed(2);var g=d.getStringValue("strDisplayRate");var u=d.getStringValue("lSurplusAmount");var o=d.getStringValue("lId");var c=d.getStringValue("strLendModelDesc");_obj.productName=l;_obj.html("title_id",l);_obj.html("nLenderYearRate_id",g);if(g.indexOf("-")!=-1){var m=g.split("-");_obj.html("nLenderYearRate_id2",m[1])}else{_obj.html("nLenderYearRate_id2",g)}_obj.html("deadline_id",r+h);_obj.html("deadline_id2",r+h);_obj.html("info_id",c);_obj.html("numberPeople_id","累计加入"+f+"人");if(u>0){_obj.surplusAmount=u/100}_obj.nDayUnit=j;_obj.rate=Number(w/10000).toFixed(4);_obj.rate2=i;_obj.nDayCount=r;_obj.lMinInvestAmount=b;_obj.strLendModelCode=k;_obj.lLimitAmount=q;_obj.lProductId=o;_obj.secondLoad();_obj.setMaxMoney();var a="";if(q==0){a="起投金额"+b+"元"}else{a="投资金额"+b+"~"+_obj.maxMoney+"元"}_obj.get("lMinInvestAmount_id").setAttribute("placeholder",a);if(d.exists("cdosLendProductPaymentType")){var n=d.getCDOArrayValue("cdosLendProductPaymentType");for(var p=0;p<n.length;p++){_obj.payType+=n[p].getStringValue("strPaymentTypeCode")+","}}}else{var x=getStringValue("titleName");if(x&&x.length>0){x=decodeURI(x);_obj.html("title_id",x)}_obj.contentShow();_Not.show("content_id","该产品已停用")}}_obj.secondLoad=function(){if("1003"==_obj.strLendModelCode&&_obj.lMinInvestAmount==_obj.lLimitAmount){_obj.show("edit_money_id",false);_obj.show("fix_money_id",true);_obj.html("fix_child_money_id","固定投资金额"+_obj.lMinInvestAmount+"元");_obj.fixFlag=true;_obj.dealCode=2}else{if("1003"==_obj.strLendModelCode){_obj.dealCode=1}if("1002"==_obj.strLendModelCode){_obj.dealCode=0;_obj.html("profit_id","预期年化最高收益率")}}if("1004"==_obj.strLendModelCode){_obj.show("div_half_id2",true);_obj.show("info_id2",true);_obj.show("numberPeople_id",true);_obj.html("info_id2","收益率"+_obj.rate2+"%起,逐月涨 0.5%,<br/>最高 12%每月随取1次机会");_obj.html("hint_id","买入成功后，次日计息");_obj.html("profit_id2","预期年化最高收益率");_obj.dealCode=0}else{_obj.show("div_half_id",true);_obj.show("info_id",true);_obj.hint(_obj.lMinInvestAmount)}_obj.contentShow()};_obj.contentShow=function(){_shade_layer.hide();_obj.show("content_id",true)};_obj.hint=function(a){var b=0;if("1002"==_obj.strLendModelCode){b=Number(a*12*0.054).toFixed(2);if(a==null||a==""){a=0}_obj.html("hint_id","如您每月投资"+a+"元，12个月后预计收益"+b+"元");return true}if(_obj.nDayUnit=="2"){b=Number(a*_obj.rate*_obj.nDayCount).toFixed(2)}else{if(_obj.nDayUnit=="1"){b=Number(numMulti(a*_obj.rate/12,_obj.nDayCount)).toFixed(2)}else{b=Number(numMulti(a*_obj.rate/365,_obj.nDayCount)).toFixed(2)}}if(a==null||a==""){a=0}_obj.html("hint_id","如您投资"+a+"元，预计到期收益："+b+"元")};function numMulti(d,b){var a=0;try{a+=d.toString().split(".")[1].length}catch(c){}try{a+=b.toString().split(".")[1].length}catch(c){}return Number(d.toString().replace(".",""))*Number(b.toString().replace(".",""))/Math.pow(10,a)}_obj.setMaxMoney=function(){var a=0;var b=0;if(_obj.lLimitAmount==0){b=9999999}else{b=_obj.lLimitAmount}if(_obj.surplusAmount==-1){a=b}else{if(Number(_obj.surplusAmount)>b){a=b}else{a=Number(_obj.surplusAmount)}}_obj.maxMoney=a};_obj.inputMoney=function(b){if("1004"==_obj.strLendModelCode){return}var a=/^[1-9]{1}\d*$/g;var c=b.value;if(c.length>0&&!a.test(c)){c=0;info("请输入数字类型");b.value="";_obj.hint(c);return false}if(c>Number(_obj.maxMoney)){info("金额不能超过"+_obj.maxMoney+"元");c=0;b.value="";_obj.hint(c);return false}_obj.hint(c);return true};_obj.changePic=function(a){var b=a.src;if(b.indexOf("dx_02.png")>-1){_obj.xieyiVal=0;a.src="../img/public/dx_01.png"}else{_obj.xieyiVal=1;a.src="../img/public/dx_02.png"}};_obj.buyFlag=true;_obj.buyStyle=function(a){if(a==true){_obj.get("buy_id").style.display="block";_obj.get("buy_in_id").style.display="none";_obj.payFlag=true}else{_obj.get("buy_id").style.display="none";_obj.get("buy_in_id").style.display="block";_obj.payFlag=false}};_obj.buy=function(){javascript:scrollTo(0,0);if(_obj.payFlag==false){return}var a=_obj.buyingVerify();if(a==false){_obj.buyStyle(true);return}_obj.realNameIde();_obj.buyStyle(false)};_obj.buying=function(){setStringValue("money",_obj.money);setStringValue("lProductId",_obj.lProductId);setStringValue("type","1");setStringValue("payType",_obj.payType);openWindow("lend/pay.htm","支付页面","dPage=productDetail.htm",0);_obj.buyStyle(true)};_obj.buyingVerify=function(){var a=0;if(_obj.fixFlag==true){a=_obj.lLimitAmount||0}else{a=_obj.get("lMinInvestAmount_id").value||0;if(a%100!=0){info("请输入100的整数倍");return false}if(Number(a)<Number(_obj.lMinInvestAmount)){info("请输入不小于"+_obj.lMinInvestAmount+"元的投资金额");return false}}if(_obj.xieyiVal==0){info("请同意协议");_obj.buyStyle(true);return false}_obj.money=a;return true};_obj.realNameIde=function(){var a=new CDO();a.setStringValue("strServiceName","CommonService");a.setStringValue("strTransName","queryIdentityOrPayPwd");a.setLongValue("lUserId",Number(_obj.lUserId));raiseTrans(a,"callBackRealNameIde")};function callBackRealNameIde(d,f,a){if(_obj.ret(a,"查询是否实名认证失败")==false){_obj.buyStyle(true);return false}if(a.nCode==0&&f.exists("nIdentityState")){var c=f.getIntegerValue("nIdentityState");var e=f.exists("nProtocolState")?f.getIntegerValue("nProtocolState"):10;_obj.nProtocolState=e;if(c==90||c==100){var b=f.getIntegerValue("nIsSetPayPwd");if(b==0){_obj.setPayPwd()}else{if(b==1){if(e==90||e==100||e==20){_obj.buying();return}_obj.goProtocolPage(e)}}}else{_obj.goIdenPage(c)}}_obj.buyStyle(true)}_obj.goIdenPage=function(a){if(a==10){_TTPopups.open2({content:"您未实名认证，请认证",cancelBtn:"否",submitBtn:"是",closeCallBack:"TT_pay_sm_1"})}else{if(a==20){info("您的实名认证正在认证中，请稍候查看实名认证");_obj.buyStyle(true)}else{if(a==30){_TTPopups.open2({content:"您的实名认证失败,查看原因",cancelBtn:"否",submitBtn:"是",closeCallBack:"TT_pay_sm_2"})}}}};function TT_pay_sm_1(a){if(a==1){setTimeout(function(){openWindow("myCenter/securityCenter/accountIdCard.htm","实名认证","clearUser=1&nIdentityState=10",0)},300)}_obj.buyStyle(true)}function TT_pay_sm_2(a){if(a==1){setTimeout(function(){openWindow("myCenter/securityCenter/accountIdCard.htm","实名认证","clearUser=1&nIdentityState=30",0)},300)}_obj.buyStyle(true)}_obj.goProtocolPage=function(a){if(a==10){_TTPopups.open2({content:"投资前需要签约代扣协议",cancelBtn:"取消",submitBtn:"前往",closeCallBack:"TT_pay_dk_1"});return false}};function TT_pay_dk_1(a){if(a==1){callProtocol(1,"","lend/productDetail.htm")}_obj.buyStyle(true)}_obj.loadInvestList=function(){setStringValue("lId",_obj.lId);var a=_obj.productName;a=encodeURI(a);setStringValue("productName",a);setStringValue("investListType","1");openWindow("lend/investList.htm","投资记录","",0)};_obj.openDeal=function(){var a=-1;setStringValue("pName",_obj.productName);if(_obj.dealCode==0){if("1004"==_obj.strLendModelCode){openWindow("model/xieyi_dafy_wklc.htm","悟空理财","",0,"")}else{if("1000"==_obj.strLendModelCode){openWindow("model/xieyi_dafy_fgdqx_hs1000.htm","1000","",0,"")}else{if("1001"==_obj.strLendModelCode){openWindow("model/xieyi_dafy_fgdqx_hs1001.htm","1001","",0,"")}else{if("1002"==_obj.strLendModelCode){openWindow("model/xieyi_dafy_fgdqx_hs1002.htm","1002","",0,"")}}}}}else{if(_obj.dealCode==1){openWindow("model/xieyi_dafy_gdqx_dfb.htm","固定期限达飞宝","",0,"")}else{if(_obj.dealCode==2){openWindow("model/xieyi_dafy_tzscp.htm","投资送产品","",0,"")}}}};_obj.setPayPwd=function(){_TTPopups.open2({content:"您没有设置支付密码,去设置",cancelBtn:"取消",submitBtn:"确定",closeCallBack:"callBackOpenPay"})};function callBackOpenPay(a){if(a==1){_obj.buyStyle(true);openWindow("myCenter/securityCenter/payPwdSet.htm","设置支付密码","",0)}else{_obj.buyStyle(true)}}_obj.ret=function(a,b){if(a==null||typeof a=="undefined"){info(b);return false}if(a.nCode!=0){info(a.strText);return false}};_obj.get=function(a){return document.getElementById(a)};_obj.show=function(c,b){if((typeof c==="string")&&c.constructor==String){c=document.getElementById(c)}if(c){var a=b==true?"block":"none";c.style.display=a}};_obj.html=function(b,a){if((typeof b==="string")&&b.constructor==String){b=document.getElementById(b)}if(b){b.innerHTML="";b.innerHTML=a}};_obj.back=function(){openDelayWindow(_obj.productBackURL,"产品超市","","1","","1")};jsHeight.bodyheight("mrys_bag");