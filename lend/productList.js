var _obj={};_obj.pageSize=10;_obj.pageIndex=0;_obj.loadFlag=true;_obj.asynFlag=true;_obj.typeCode=0;_obj.type=0;_obj.chooiceFlag=true;_obj.typeName="";_obj.lLenderId=-1;_obj.timeFlag=true;_obj.findTag="";_obj.nowTime="";_obj.productListBackURL="index.htm";_obj.nowTimeTiming="";_obj.timeIsFlag=true;_obj.time;jsHeight.bodyheight();window.onload=function(){_obj.dom=document.getElementById("dataList_id");_obj.findTag=getQueryString("findTag")||0;_obj.productListBackURL=getStringValue("productListBackURL")||"index.htm";EngineClass.clearArray(["productListBackURL"]);_obj.loadType();EngineClass.setBackURL(_obj.productListBackURL,"首页","",1,"")};_obj.loadType=function(){var a=new CDO();a.setStringValue("strServiceName","CommonService");a.setStringValue("strTransName","getLendCategoryListByMobile");EngineClass.raiseTrans(a,"callBackGenerateTypePage")};function callBackGenerateTypePage(c,d,b){if(_obj.ret(b,"请求失败")==false){return}if(b.nCode==0&&d.exists("cdosRecord")){var a=d.getCDOArrayValue("cdosRecord");var m="";for(var e=0;e<a.length;e++){var l=a[e];var h=l.getLongValue("strCode");var g=l.getStringValue("strName");if(e==0){_obj.typeCode=h;_obj.typeName=g;m+='<li class="row" id="dflcId" style="border-right: 1px solid #007AFF;" strCode='+h+"  strName="+g+" onclick=\"_obj.chooseProduct(this,'"+h+"','"+g+"')\">"+g+"</li>"}else{m+='<li id="dfhdId"  strCode='+h+" strName="+g+" onclick=\"_obj.chooseProduct(this,'"+h+"','"+g+"')\">"+g+"</li>"}}_obj.html("type_ul_id",m);if(m.length==0){_obj.type=1;_obj.typeCode="zqzr"}var f=getStringValue("productType");clearArray(["productType"]);if(f==1){var k=document.getElementById("dfhdId");var g=k.getAttribute("strName");var h=k.getAttribute("strCode");_obj.chooseProduct(k,h,g)}else{if(_obj.findTag==1||f==2){var i=document.getElementById("zqzrId");_obj.chooseProduct(i,"zqzr","债权转让")}else{_shade_layer.show("加载中,请稍候......");_obj.loadData()}}_obj.show("div_ul_id",true)}else{_obj.showContent();_Not.show("main_div_id","暂无数据")}}_obj.loadData=function(){_obj.asynFlag=false;var b=_obj.pageIndex*_obj.pageSize;if(_obj.type==0){var a=new CDO();a.setStringValue("strServiceName","CommonService");a.setStringValue("strTransName","getDeptLendProductListForMobile");a.setIntegerValue("nRecordOffset",b);a.setIntegerValue("nPageSize",_obj.pageSize);a.setIntegerValue("nTestFlag",0);a.setStringValue("strLendCategoryCode",_obj.typeCode);raiseTrans(a,"callBackGeneratePage")}else{var a=new CDO();a.setStringValue("strServiceName","CommonService");a.setStringValue("strTransName","getRdptApplyListForMobile");a.setIntegerValue("nRecordOffset",b);a.setIntegerValue("nPageSize",_obj.pageSize);raiseTrans(a,"callBackGeneratePage")}};function callBackGeneratePage(b,d,a){if(_obj.pageIndex==0){_obj.dom.innerHTML=""}if(_obj.ret(a,"请求失败")==false){_shade_layer.hide();return}var e=d.getIntegerValue("nRecordCount");if(e==0){_obj.showContent();_Not.show("dataList_id","暂无数据");_shade_layer.hide();return}if(d.exists("cdosRecord")){var c=d.getCDOArrayValue("cdosRecord");if(c.length==0&&_obj.pageIndex==0){_obj.showContent();_Not.show("dataList_id","暂无数据");_shade_layer.hide();return}}if(_obj.typeCode.toString()=="2"){_obj.generateActivity(b,d,a)}else{if(_obj.type==0){_obj.generateProduct(b,d,a)}else{_obj.generateTransfer(b,d,a)}}if(_obj.pageIndex==0){_obj.showContent()}_obj.pageIndex=_obj.pageIndex+1;if(_obj.pageIndex*_obj.pageSize>=_obj.total){_obj.loadFlag=false}_shade_layer.hide()}_obj.showContent=function(){_shade_layer.hide();_obj.chooiceFlag=true};_obj.generateActivity=function(d,f,c){if(c.nCode==0&&f.exists("cdosRecord")){_obj.total=Number(f.getIntegerValue("nRecordCount"));_obj.nowTime=f.getStringValue("nowTime");var a=f.getCDOArrayValue("cdosRecord");window.clearInterval(_obj.nowTimeTiming);_obj.setNowTimeTiming();var j=document.getElementById("hide_activity_id");var e=document.getElementById("hide_div_id");var k=false;for(var h=0;h<a.length;h++){var g=a[h];var l=g.getStringValue("nIsMarketProduct");var b=g.getStringValue("strEndDate");if(l==1){_obj.generateProductPage(e,g)}else{_obj.generateActivityPage(j,g)}}if(_obj.timeFlag==true){_obj.timeFlag=false;_obj.ShowCountDown()}_obj.asynFlag=true}};_obj.generateProduct=function(f,h,d){if(d.nCode==0&&h.exists("cdosRecord")){_obj.total=Number(h.getIntegerValue("nRecordCount"));var b=h.getCDOArrayValue("cdosRecord");var l=document.getElementById("hide_div_id");for(var k=0;k<b.length;k++){var j=b[k];var g=j.getStringValue("strPreSalesTime");var c=j.getStringValue("strEndDate");var m=j.getStringValue("canSell");if(g&&g.length>0){var a=_obj.timeDiff(g);if(a>0){continue}}if(c&&c.length>0){if(c.length<13){c=c+"23:59:59"}var e=_obj.timeDiff(c);if(e<=0){continue}}if(m==0){continue}_obj.generateProductPage(l,j)}_obj.asynFlag=true}};_obj.generateActivityPage=function(h,r){var q=h.innerHTML;var y="../img/lend/app_qiang.png";var i="1";var p=r.getStringValue("lId");var c=r.getStringValue("strEndDate");var a=r.getStringValue("nLendExtRate");var A=r.getStringValue("strPreSalesTime");var v=Number(r.getStringValue("lLimitAmount"))||0;var e=Number(r.getStringValue("lPreSalesAmount"))||0;var d=r.getCDOArrayValue("cdosLendProductBuildGoods");var b=0;if(v!=0){b=(Number(e/v||0)*100).toFixed(2)||0}var l=r.getStringValue("strLendModelCode");q=q.replace("#type#","-2");q=q.replace("#lId#",r.getStringValue("lId"));q=q.replace("#strName#",r.getStringValue("strName"));q=q.replace("#productName#",r.getStringValue("strName"));q=q.replace("#lMinInvestAmount#",(Number(r.getStringValue("lMinInvestAmount"))/100).toFixed(0));if(a){a=(Number(a)/100).toFixed(1)+"%";q=q.replace("#nLenderYearRate#",r.getStringValue("strDisplayRate")+"<span class='fin_jia'>+"+a+"</span>")}else{var g=r.getStringValue("strDisplayRate");if(l=="1004"){if(g.indexOf("-")!=-1){var n=g.split("-");q=q.replace("#nLenderYearRate#",jQuery.trim(n[1]))}else{q=q.replace("#nLenderYearRate#",g)}q=q.replace("#strRate#","预期年化最高收益率")}else{if(l=="1002"){q=q.replace("#nLenderYearRate#",g);q=q.replace("#strRate#","预期年化最高收益率")}else{q=q.replace("#nLenderYearRate#",g);q=q.replace("#strRate#","预期年化收益率")}}}var k=r.getStringValue("nDayUnit");var j=k=="2"?"年":(k=="1"?"个月":"天");q=q.replace("#deadline#",r.getStringValue("nDayCount")+j);if(A&&A.length>0){var x=_obj.timeDiff(A);if(x>0){y="../img/lend/app_yu.png"}}if(b==100){y="../img/lend/app_qin.png";i="0"}if(c&&c.length>0){if(c.length<13){c=c+"23:59:59"}var o=_obj.timeDiff(c);if(o<=0){y="../img/lend/app_qin.png";i="0"}}if(v!=0&&(v-e)<0){y="../img/lend/app_qin.png";i="0"}q=q.replace("#imgURL#",y);var f=$("<li percent="+b+" state="+i+">"+q+"</li>");var w=f.find("#lc_bt_title");if(A&&A.length>0){var z=_obj.isSell(A);if(z==true){if(i=="1"){w.prepend('<span class="ilistcount_time" style="float:right" time=\''+A+"'></span>")}}}if(d&&d.length>0){for(var u=0;u<d.length;u++){var m=d[u].getStringValue("strGoodsName");w.append('<span class="fina_sales borderFF0 colorFF0" >'+m+"</span>")}}$("#dataList_id").append(f)};_obj.generateProductPage=function(h,a){var c=h.innerHTML;var i=a.getStringValue("lId");var g=Number(a.getStringValue("lLimitAmount"))||0;var j=Number(a.getStringValue("lPreSalesAmount"))||0;var d=a.getStringValue("strLendModelCode");if(g!=0&&g==j){return}c=c.replace("#lId#",a.getStringValue("lId"));c=c.replace("#type#","-1");c=c.replace("#strName#",a.getStringValue("strName"));c=c.replace("#productName#",a.getStringValue("strName"));var l=a.getStringValue("strDisplayRate");if(d=="1004"){if(l.indexOf("-")!=-1){var e=l.split("-");c=c.replace("#nLenderYearRate#",jQuery.trim(e[1]))}else{c=c.replace("#nLenderYearRate#",l)}c=c.replace("#strRate#","预期年化最高收益率")}else{if(d=="1002"){c=c.replace("#nLenderYearRate#",l);c=c.replace("#strRate#","预期年化最高收益率")}else{c=c.replace("#nLenderYearRate#",l);c=c.replace("#strRate#","预期年化收益率")}}c=c.replace("#lMinInvestAmount#",(Number(a.getStringValue("lMinInvestAmount"))/100).toFixed(0));var b=a.getStringValue("nDayUnit");var f=b=="2"?"年":(b=="1"?"个月":"天");c=c.replace("#deadline#",a.getStringValue("nDayCount")+f);var k=document.createElement("li");k.innerHTML=c;_obj.dom.appendChild(k)};_obj.generateTransfer=function(c,f,b){if(b.nCode==0&&f.exists("cdosRecord")){_obj.total=Number(f.getIntegerValue("nRecordCount"));var a=f.getCDOArrayValue("cdosRecord");var m=document.getElementById("hide_debt_div_id");for(var h=0;h<a.length;h++){var j=m.innerHTML;var g=a[h];var l=g.getStringValue("lId");var d=Number(g.getLongValue("lAmount"));var e=Number(g.getLongValue("lContributedAmount"))||0;var k=(Number(e/d)*100).toFixed(2)||0;_obj.creditorFlag=d==e;j=j.replace("#lId#",g.getStringValue("lId"));j=j.replace("#lLenderId#",g.getStringValue("lLenderId"));j=j.replace("#strLendProductName#",g.getStringValue("strLendProductName"));j=j.replace("#nLenderYearRate#",_obj.getMoney(g.getStringValue("nLenderYearRate"),2)+"%");j=j.replace("#percent#",k);j=j.replace("#nSurplusDayCount#",g.getStringValue("nSurplusDayCount"));j=j.replace("#lAmount#",_obj.getMoney(d,0));var n=document.createElement("li");n.innerHTML=j;_obj.dom.appendChild(n)}_obj.asynFlag=true;setTimeout(function(){_obj.setRing()},200)}};_obj.openDetail=function(e,g,h,i){var c=getStringValue("lUserId");if(c==null||typeof c=="undefined"){info("请登录后在购买");return}clearArray(["lId"]);setStringValue("lId",g);setStringValue("productBackURL","lend/productList.htm");setStringValue("productType","0");if(i&&i.length>0){i=encodeURI(i);setStringValue("titleName",i)}if(_obj.type==1){var d=_obj.creditorFlag==true?0:1;var b=_obj.creditorFlag==true?"lend/rightsDetail.htm":"lend/creditorDetail.htm";setStringValue("openPageType",d);setStringValue("lLenderId",h);openWindow(b,"债权转让详情","",0)}else{if(h==-2){var f=e.parentNode.getAttribute("percent");if(Number(f)==100){info("该产品已经卖完了");return}var a=e.parentNode.getAttribute("state");if(a=="0"){info("该活动已截止");return}openWindow("lend/activityDetail.htm","活动产品详情","",0)}else{openWindow("lend/productDetail.htm","产品详情","",0)}}};_obj.chooseProduct=function(d,c,a){var b=jQuery(d);if(d.className=="row"){return}if(_obj.chooiceFlag==false){info("正在加载"+_obj.typeName+"下的内容,请不要频繁切换");return}_obj.typeName=a;b.addClass("row").siblings("li").removeClass();if("zqzr"==c){_obj.type=1;_obj.typeCode=0}else{_obj.type=0;_obj.typeCode=c}_obj.dom.innerHTML="";_obj.timeIsFlag=true;if(_obj.time){window.clearInterval(_obj.time)}_obj.timeFlag=true;_obj.pageIndex=0;_obj.loadFlag=true;_obj.asynFlag=true;_shade_layer.show("加载中,请稍候......");_obj.loadData();_obj.chooiceFlag=false};_obj.setRing=function(){jQuery("#dataList_id").find(".circle[use=0]").each(function(b,d){var c=jQuery(d);var a=c.find("span").text()*3.6||0;a=Number(a);if(a<=180){c.find(".right").css("transform","rotate("+a+"deg)")}else{c.find(".right").css("transform","rotate(180deg)");c.find(".left").css("transform","rotate("+(a-180)+"deg)")}d.setAttribute("use","1")})};_obj.isSell=function(a){var b=_obj.timeDiff(a);if(b<0){return false}var c=Math.floor(b/(24*3600*1000));if(c>0){return false}else{return true}};_obj.ShowCountDown=function(){$("span[time]").each(function(j,d){var a=d.getAttribute("time");var l=_obj.timeDiff(a);var g=l%(24*3600*1000);var i=Math.floor(g/(3600*1000));var e=g%(3600*1000);var b=Math.floor(e/(60*1000));var c=e%(60*1000);s=Math.round(c/1000);var f="距离开售 ";var k=true;if(i<10){i="0"+i}if(b<10){b="0"+b}if(s<10){s="0"+s}if(i>0){f=f+"<a>"+i+"</a>:<a>"+b+"</a>:<a>"+s+"</a>"}else{if(b>0){i="00";f=f+"<a>"+i+"</a>:<a>"+b+"</a>:<a>"+s+"</a>"}else{if(s==0){k=false}s="<a>00</a>:<a>00</a>:<a>"+s+"</a>";f=f+s}}if(k==true){d.innerHTML=f}else{d.removeAttribute("time");d.innerHTML="";jQuery(d).parent().parent().parent().find("img").attr("src","../img/lend/app_qiang.png")}});if(_obj.timeIsFlag==true){_obj.time=setInterval(function(){_obj.timeIsFlag=false;_obj.ShowCountDown()},960)}};_obj.timeDiff=function(f){var c=(_obj.nowTime).replace(/-/g,"/");var a=(f).replace(/-/g,"/");var e=new Date(c);var d=new Date(a);var b=d.getTime()-e.getTime();return b};_obj.addTime=function(d,c){var e=d.replace(/-/g,"/");var b=new Date(e);b.setTime(b.getTime()+c*1000);var a=b.Format("yyyy-MM-dd hh:mm:ss");return a};_obj.setNowTimeTiming=function(){_obj.nowTimeTiming=setInterval(function(){_obj.nowTime=_obj.addTime(_obj.nowTime,1)},1000)};_obj.getMoney=function(b,a){return Number(Number(b)/100).toFixed(a)};_obj.ret=function(a,b){if(a==null||typeof a=="undefined"){info(b);_shade_layer.hide();_obj.chooiceFlag=true;return false}if(a.nCode!=0){info(a.strText);_shade_layer.hide();_obj.chooiceFlag=true;return false}return true};_obj.get=function(a){return document.getElementById(a)};_obj.show=function(c,b){if((typeof c==="string")&&c.constructor==String){c=document.getElementById(c)}if(c){var a=b==true?"block":"none";c.style.display=a}};_obj.html=function(b,a){if((typeof b==="string")&&b.constructor==String){b=document.getElementById(b)}if(b){b.innerHTML="";b.innerHTML=a}};jQuery(document).scroll(function(){var b=$(this).scrollTop();var a=$(document).height();var c=$(this).height();if(b+c>=a){if(_obj.asynFlag==true&&_obj.loadFlag==true){_obj.loadData()}}});function backMethod(){openWindow(_obj.productListBackURL,"首页","",1,"","1")};