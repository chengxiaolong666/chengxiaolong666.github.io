var strFullDistrictName="";var cdosCityInfo=new Array();var strProvince="";var strCity="";var strcounty="";var strProvinceCode=0;var strCityCode=0;var strcountyCode=0;var lBuyerId=0;var addressFlag=true;jsHeight.bodyheight();$(document).ready(function(){lBuyerId=getStringValue("lUserId");showUserAddress()});function showUserAddress(){var b=getStringValue("lUserId");var a=new CDO();a.setStringValue("strServiceName","UserService");a.setStringValue("strTransName","getBillingInfo");a.setLongValue("lUserId",Number(b));raiseTrans(a,"callBackForGetBillingInfo2")}function callBackForGetBillingInfo2(f,g,a){if(a==undefined||a==null){info("请求失败!");return false}if(a.nCode==0){if(g.exists("cdoBilling")){var e=g.getCDOValue("cdoBilling");var c=e.getStringValue("strBillingName");var b=e.getStringValue("strBillingMobile");strProvinceCode=e.getStringValue("strBillingProvinceCode");strProvince=e.getStringValue("strBillingProvinceName");strCityCode=e.getStringValue("strBillingCityCode");strCity=e.getStringValue("strBillingCityName");strcountyCode=e.getStringValue("strBillingDistrictCode");strcounty=e.getStringValue("strBillingDistrictName");var d=e.getStringValue("strBillingAddress");var h=e.getStringValue("strBillingPostAddress");strFullDistrictName=strProvince+" "+strCity+" "+strcounty;$("#strConsigneeName").val(c);$("#strMobile").val(b);$("#strFullDistrictName").html(strFullDistrictName);$("#strAdress").val(d);$("#strBillingPostAddress").val(h);$("#strAdress_province").val(strProvinceCode);$("#strAdress_city").val(strCityCode);$("#strAdress_area").val(strcountyCode)}}else{info("请求失败："+a.strText)}}function addAddress(a){javascript:scrollTo(0,0);_TTPopups.open2({content:"请确定要修改当前地址吗？",cancelBtn:"否",submitBtn:"是",closeCallBack:"TT_editAddress"})}function TT_editAddress(){var b=jQuery("#strAdress").val();var c=jQuery("#strConsigneeName").val();var a=jQuery("#strMobile").val();if(a!=null){a=trim(a)}var f=jQuery("#strBillingPostAddress").val();if(f!=null){f=trim(f)}if(strProvince==undefined||strProvince==null||strProvince==""||strCity==undefined||strCity==null||strCity==""||strcounty==undefined||strcounty==null||strcounty==""||b==undefined||b==null||b==""||lBuyerId==undefined||lBuyerId==null||lBuyerId==""||c==undefined||c==null||c==""||a==undefined||a==null||a==""||strProvinceCode==undefined||strProvinceCode==null||strProvinceCode==""||strCityCode==undefined||strCityCode==null||strCityCode==""||strcountyCode==undefined||strcountyCode==null||strcountyCode==""||f==undefined||f==null||f==""){info("请完善地址信息！");return false}if(isNaN(a)||a.length!=11||a.substr(0,1)!="1"){info("手机号格式有误！");return false}if(!checkPostAddress(f)){return false}var e=jQuery("#strIsDefault").attr("checked")=="checked";var b=jQuery("#strAdress").val();var c=jQuery("#strConsigneeName").val();var a=jQuery("#strMobile").val();var d=new CDO();d.setLongValue("lUserId",lBuyerId);d.setStringValue("strBillingAddress",b);d.setStringValue("strBillingName",c);d.setStringValue("strBillingMobile",a);d.setStringValue("strBillingPostAddress",f);d.setStringValue("strBillingProvinceCode",strProvinceCode);d.setStringValue("strBillingProvinceName",strProvince);d.setStringValue("strBillingCityCode",strCityCode);d.setStringValue("strBillingCityName",strCity);d.setStringValue("strBillingDistrictCode",strcountyCode);d.setStringValue("strBillingDistrictName",strcounty);if(addressFlag){addressFlag=false;$("#saveAdd1").hide();$("#saveAdd2").show();d.setStringValue("strServiceName","UserService");d.setStringValue("strTransName","updateBillingInfo");raiseTrans(d,"callBackForUpdateBillingInfo")}}function callBackForUpdateBillingInfo(b,c,a){addressFlag=true;$("#saveAdd1").show();$("#saveAdd2").hide();if(a==undefined||a==null||a.nCode!=0){info("编辑当前地址信息失败!");return false}info("编辑成功！");setTimeout(function(){openDelayWindow("myCenter/userInfo/personalInformation.htm","个人信息","",1,"",1)},1000)}jsHeight.bodyheight();