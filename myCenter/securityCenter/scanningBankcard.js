jsHeight.bodyheight();var num=0;var scanningBankcard={};scanningBankcard.bankCode="";scanningBankcard.bankName="";scanningBankcard.cardNumber="";scanningBankcard.cardType="";scanningBankcard.cradName="";scanningBankcard.photoUrl="";scanningBankcard.bankCode2="";scanningBankcard.nIdentityState="";window.onload=function(){scanningBankcard.bankCode=getStringValue("bankCode");scanningBankcard.bankName=getStringValue("bankName");scanningBankcard.cardNumber=getStringValue("cardNumber");scanningBankcard.cardType=getStringValue("cardType");scanningBankcard.cradName=getStringValue("cradName");scanningBankcard.photoUrl=getQueryString("photoUrl");scanningBankcard.nIdentityState=getQueryString("nIdentityState");$("#card_url").attr("src",scanningBankcard.photoUrl);$("#card_number").val(scanningBankcard.cardNumber);formatBankNo(document.getElementById("card_number"),0);$("#bank_type").html(scanningBankcard.cardType);$("#bank_name").html(scanningBankcard.bankName);formatBankType();if(trim(scanningBankcard.bankCode).length>0&&trim(scanningBankcard.bankName).length>0&&trim(scanningBankcard.cardType).length>0){$("#sub_ok").show();$("#sub_ok_mark").show();$("#bank_list_div").show();$("#mark").hide()}else{$("#sub_ok").hide();$("#sub_ok_mark").hide();$("#mark").hide();$("#bank_list_div").hide()}};var formatBankNo=function(c,b){if(c.value==""){return}var f=new String(c.value);var d=new String(trim(c.value));if(d.length>22){info("您输入的卡号有误!");return}if(d.length>14&&b==1){checkBankcard("callBackCheckBankcard",trim(c.value))}f=f.substring(0,25);if(f.match(".[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{7}")==null){if(f.match(".[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{7}|.[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{7}|.[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{7}|.[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{7}")==null){var a=accountChar="",e;for(e=0;e<f.length;e++){accountChar=f.substr(e,1);if(!isNaN(accountChar)&&(accountChar!=" ")){a=a+accountChar}}f="";for(e=0;e<a.length;e++){if(e==4){f=f+" "}if(e==8){f=f+" "}if(e==12){f=f+" "}if(e==16){f=f+" "}f=f+a.substr(e,1)}}}else{f=" "+f.substring(1,5)+" "+f.substring(6,10)+" "+f.substring(14,18)+"-"+f.substring(18,25)}if(f!=c.value){c.value=f}};var formatBankType=function(){var b=scanningBankcard.bankCode.toString().substring(1,4);b=bankMapping.getConstant(b);if(b==null){$("#bank_img").hide();return}scanningBankcard.bankCode2=b;var a="";a="../../img/logo"+b+".png";$("#bank_logo").attr("src",a)};var submitBankCard=function(){var a=$("#card_number").val();if(a==""||a==null){alert("请输入银行卡号");return}bankName=escape(scanningBankcard.bankName);setStringValue("bankName",scanningBankcard.bankName);var b="cardNumber="+trim(a)+"&bankCode="+scanningBankcard.bankCode2+"&nIdentityState="+scanningBankcard.nIdentityState+"&clearUser=1&isRefresh=1";openWindow("myCenter/securityCenter/accountIdCard.htm","获取到的卡号",b,0)};var checkBankNumber=function(){var a=$("#card_number").val();if(a==""||a==null){alert("请输入银行卡号");return}checkBankcard("callBackCheckBankcard",trim(a))};var callBackCheckBankcard=function(c,b,a,d){scanningBankcard.bankCode=c;scanningBankcard.bankName=b;scanningBankcard.cardType=a;scanningBankcard.cradName=d;if(trim(c).length>0&&trim(b).length>0&&trim(a).length>0){$("#bank_type").html(scanningBankcard.cardType);$("#bank_name").html(scanningBankcard.bankName);formatBankType();$("#bank_list_div").show()}else{$("#bank_list_div").hide()}if(checkCredit(a)){$("mark").html("不支持信用卡!");$("#mark").show();$("#sub_ok").hide();$("#sub_ok_mark").hide()}else{if(!checkSupportCard(c)){$("mark").html("不支持该行的银行卡!");$("#mark").show();$("#sub_ok").hide();$("#sub_ok_mark").hide()}else{$("#mark").hide();$("#sub_ok").show();$("#sub_ok_mark").show()}}};var checkCredit=function(a){if(a.indexOf("信用卡")>=0||a.indexOf("贷记卡")>=0){return true}return false};var checkSupportCard=function(b){b=b.toString().substring(1,4);b=bankMapping.getConstant(b);var a=getStringValue("bankCodeSelect");if(b!=""&&b!=undefined&&a.indexOf(b)>=0){return true}return false};