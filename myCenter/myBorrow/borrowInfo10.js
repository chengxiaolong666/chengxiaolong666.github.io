var borrowInfo1={};borrowInfo1.strBorrowerMonthRate=0;borrowInfo1.strAmount=0;borrowInfo1.strCreateTime="";borrowInfo1.lId="";borrowInfo1.strStateDesc="";borrowInfo1.strContractNo="";borrowInfo1.strConsultNo="";borrowInfo1.strVersionType="";borrowInfo1.userName="";borrowInfo1.lBorrowerId="";borrowInfo1.isViewHK="";borrowInfo1.isViewBFHK="";borrowInfo1.applyId="";jsHeight.bodyheight();window.onload=function(){_shade_layer.show("努力加载中,请稍候...");setTimeout(function(){borrowInfo1.strAmount=getQueryString("strAmount");borrowInfo1.strCreateTime=getQueryString("strCreateTime");borrowInfo1.strBorrowerMonthRate=getQueryString("strBorrowerMonthRate");borrowInfo1.strStateDesc=getQueryString("strStateDesc");borrowInfo1.lId=getQueryString("lId");borrowInfo1.strVersionType=getQueryString("strVersionType");$("#strAmount").html((borrowInfo1.strAmount));$("#strCreateTime").html("借款时间:"+borrowInfo1.strCreateTime);$("#strBorrowerMonthRate").html("日利率:0.1167%");$("#lId").html("借款编号:"+borrowInfo1.lId);getBillForMobile(borrowInfo1.lId,borrowInfo1.strVersionType)},300)};var getBillForMobile=function(c,a){var b=new CDO();borrowInfo1.lBorrowerId=getStringValue("lOldCustomerId");borrowInfo1.userName=getStringValue("strMobile");b.setStringValue("strServiceName","CommonService");b.setStringValue("strTransName","getRepayMentInfo");b.setLongValue("lBorrowerId",Number(borrowInfo1.lBorrowerId));b.setLongValue("lBorrowIntentId",Number(c));b.setStringValue("strVersionType",a);b.setStringValue("userName",borrowInfo1.userName);b.setStringValue("repayStatus",borrowInfo1.strStateDesc);raiseTrans(b,"callBackForGetBillForMobile")};function callBackForGetBillForMobile(a,c,f){if(f==undefined||f==null){_shade_layer.hide();info("请求失败!");return false}if(f.nCode==0){if(c.exists("cdosBorrowerBill")){var p=new Date().Format("yyyy-MM-dd");var q="";var k=c.getCDOValue("cdosBorrowerBill");if(k.length==0){_Not.show("borrowList","此笔借款已还完！","../../");_shade_layer.hide();return false}else{for(var d=0;d<k.length;d++){var e=k[d].getStringValue("applyId");var o=k[d].getStringValue("repayAmount");var n=k[d].getStringValue("interest");var h=k[d].getStringValue("repayDate");var b=k[d].getStringValue("overdueDays");var g=k[d].getStringValue("overdueServerMoney");var m=k[d].getStringValue("isViewHK");var j=k[d].getStringValue("isViewBFHK");q=$("#borrowInfo10ModelDiv").html();var l=document.createElement("li");q=q.replace("#applyId#",e);q=q.replace("#repayDate#",h);if(m=="0"){q=q.replace("#isViewHK#","");q=q.replace("#isViewBFHK#",j)}else{q=q.replace("#isViewHK#","display: none;")}q=q.replace("#repayMoney#",o);q=q.replace("#repayInterest#",n);q=q.replace("#repayTime#",h);q=q.replace("#beOverdueDays#",b);q=q.replace("#beOverdueMoney#",g);l.innerHTML=q;document.getElementById("borrowList").appendChild(l)}}_shade_layer.hide()}else{_shade_layer.hide()}}else{_shade_layer.hide()}}function partRepayment(b,a){var c="repayType=0&applyId="+b+"&repayDate="+a+"&lId="+borrowInfo1.lId;openWindow("myCenter/myBorrow/repayment_pay.htm","部分还款",c,0,"")}function doRepayment(c,b,a){borrowInfo1.applyId=c;var d=new CDO();d.setStringValue("strServiceName","CommonService");d.setStringValue("strTransName","checkIsAbleToRepay");d.setStringValue("applyId",borrowInfo1.lId);d.setStringValue("repaymentId",c);d.setStringValue("customerId",borrowInfo1.lBorrowerId);d.setStringValue("userName",borrowInfo1.userName);d.setStringValue("repayDate",b);d.setStringValue("isViewBFHK",a);raiseTrans(d,"callBackForCheckIsAbleToRepay")}function callBackForCheckIsAbleToRepay(a,c,e){if(e==undefined||e==null){_shade_layer.hide();info("请求失败!");return false}if(e.nCode==0){var i=c.getCDOValue("checkResult");var b=i.getStringValue("CODE");if(b=="0000"){var d=i.getStringValue("isAble");var g=i.getStringValue("isViewBFHK");if(d=="0"||d==0){info("请先还清逾期的账单!")}else{if(g=="-1"){_TTPopups.open1({title:"您是否要立即还款？",contentId:"payInfo",cancelBtn:"否",submitBtn:"是",closeCallBack:"goRepayment"})}else{var h=a.getStringValue("repaymentId");var f=a.getStringValue("repayDate");partRepayment(h,f)}}}else{info(i.getStringValue("MSG"))}}}function goRepayment(a){if(a=="0"){return false}else{var b=new CDO();b.setStringValue("strServiceName","CommonService");b.setStringValue("strTransName","repaymentItemAction");b.setStringValue("applyId",borrowInfo1.applyId+"");b.setStringValue("userName",borrowInfo1.userName);raiseTrans(b,"callBackForDoRepayment")}}function callBackForDoRepayment(d,e,a){_shade_layer.show("还款申请提交中,请稍候...");if(a==undefined||a==null){_shade_layer.hide();info("请求失败!");return false}if(a.nCode==0){var c=e.getCDOValue("payResult");var b=c.getStringValue("CODE");if(b=="000"){_shade_layer.hide();openWindow("myCenter/myBorrow/repaymentNotice.htm","还款完成","",1,"",1)}else{info(c.getStringValue("MSG"));_shade_layer.hide()}}};