jsHeight.bodyheight();var wait=60;time(document.getElementById("btn"));function time(a){if(wait==0){a.style.color="#007aff";a.innerHTML="点击获取验证码";wait=60}else{a.style.color="#cccccc";a.innerHTML="重新发送(<span style='color:red'>"+wait+"</span>)";wait--;setTimeout(function(){time(a)},1000)}}document.getElementById("btn").onclick=function(){if(wait==60){getVerifyCodeAgain()}else{return}time(this)};var lUserId="";var strName="";var strLoginId="";var strOrderSn=getQueryString("strOrderSn");var lThirdId=getQueryString("lThirdId");var backURL="";var payType=0;var lLenderId=-1;var lLendIntentId=-1;var intervalTime;$(document).ready(function(){var a=document.getElementById("app_bj_raw");FastClick.attach(a);a.addEventListener("click",function(b){closePage()},false);backURL=getQueryString("backURL");if(backURL!=""){setBackURL(backURL,"","",1,"","1")}else{setBackURL("myCenter/myIndex.htm","我的","",1,"","1")}lUserId=getStringValue("lUserId");strLoginId=getStringValue("strLoginId");strName=getStringValue("strName");payType=getStringValue("payTypeTo")||0;if(payType==1){lLenderId=getStringValue("lLenderId");lLendIntentId=getStringValue("lLendIntentId");clearArray(["payTypeTo"])}if(strOrderSn==null||strOrderSn==""){strOrderSn=getStringValue("strOrderSn")}});var submitFlag=true;$("#inc_submit").click(function(){var b=$("#verifyCode").val();if(strOrderSn==null||strOrderSn==""){info("订单号不存在");return}if(b==null||b==""){info("请输验证码");return}if(!submitFlag){return}submitFlag=false;if(payType==1){_shade_layer.show("努力加载中,请稍候...");var a=new CDO();a.setStringValue("strServiceName","LendIntentService");a.setStringValue("strTransName","confirmFastPayment");a.setStringValue("strDealSN",strOrderSn);a.setStringValue("verifyCode",b);a.setLongValue("lLenderId",lLenderId);a.setLongValue("lLendIntentId",lLendIntentId);a.setLongValue("lThirdId",lThirdId);raiseTrans(a,"callBackMattersFunc")}else{_shade_layer.show("努力加载中,请稍候...");var a=new CDO();a.setStringValue("strServiceName","BusinessCallService");a.setStringValue("strTransName","confirmFastPayment");a.setStringValue("strDealSN",strOrderSn);a.setLongValue("lThirdId",lThirdId);a.setStringValue("verifyCode",b);raiseTrans(a,"callBackForgetBankBaseInfo")}});function callBackForgetBankBaseInfo(b,c,a){if(a==null||a==undefined){submitFlag=true;info("通讯失败");_shade_layer.hide();return false}_shade_layer.hide();if(a.nCode==0){openDelayWindow("myCenter/recharge/rechargeSucceed.htm","充值处理中","payType=0",1,"")}else{info(a.strText);openDelayWindow("myCenter/recharge/rechargeSucceed.htm","充值处理中","payType=0",1,"")}submitFlag=true}function callBackMattersFunc(b,c,a){if(a==null||a==undefined){submitFlag=true;info("通讯失败");_shade_layer.hide();return false}orderConfirm()}function closeCallBackFunc(a){if(a==1){openDelayWindow("lend/pay.htm","理财支付页面","",1,"","1")}else{closePage()}}function getVerifyCodeAgain(){if(strOrderSn==null||strOrderSn==""){info("订单号不存在");return false}var a=new CDO();a.setStringValue("strServiceName","BusinessCallService");a.setStringValue("strTransName","resendFastPayVerifyCode");a.setStringValue("strDealSN",strOrderSn);a.setLongValue("lThirdId",lThirdId);raiseTrans(a,"callBackForgetVerifyCodeAgain")}function callBackForgetVerifyCodeAgain(b,c,a){if(a==null||a==undefined){info("通讯失败");return false}if(a.nCode==0){info("验证码重新发出")}else{info(a.strText)}}function closePage(){if(backURL==null||backURL==undefined||backURL==""){openDelayWindow("myCenter/myIndex.htm","我的","",1,"","1")}else{openDelayWindow(backURL,"我的","",1,"","1")}}function orderConfirm(){var a=new CDO();a.setStringValue("strServiceName","LendIntentService");a.setStringValue("strTransName","confirmFastPaymentReturn");a.setLongValue("lLendIntentId",lLendIntentId);a.setLongValue("lThirdId",lThirdId);a.setStringValue("strDealSN",strOrderSn);raiseTrans(a,"callBackOrderState")}function callBackOrderState(b,c,a){if(a==null||a==undefined){info("通讯失败");payType=1;submitFlag=true;_shade_layer.hide();return false}if(a.nCode==-90000){info(a.strText);_shade_layer.hide();payType=1;submitFlag=true;return}if(a.nCode==0){submitFlag=true;_shade_layer.hide();var d=getQueryString("dPage");if(payType==1){openWindow("lend/result.htm","支付结果页","dPage="+d,0)}else{openDelayWindow("myCenter/recharge/rechargeSucceed.htm","交易成功","dPage="+d+"&payType=1",0,"")}}else{if(a.nCode==1){setTimeout(function(){orderConfirm()},200)}else{_shade_layer.hide();payType=1;submitFlag=true;info(a.strText);return false}}};