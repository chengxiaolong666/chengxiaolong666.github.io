var isPayPwd=true;var strCallbackData="";var state=0;function checkIsPayPwd(b){strCallbackData=b;var c=getStringValue("lUserId");var a=new CDO();a.setStringValue("strServiceName","CustomerService");a.setStringValue("strTransName","queryIsSetPayPwd");a.setLongValue("lUserId",Number(c));if(isPayPwd){isPayPwd=false;raiseTrans(a,"callBackForCommonIsSetPayPwd")}}function callBackForCommonIsSetPayPwd(c,d,b){if(b==undefined||b==null){isPayPwd=true;info("请求失败!");return false}if(b.nCode==0){if(d.exists("nIsSetPayPwd")){var a=d.getIntegerValue("nIsSetPayPwd");if(a==0){isCommonAuthentication()}else{if(a==1){state=1;isCommonAuthentication()}else{info("用户中心nIsSetPayPwd数据异常")}}}else{info("用户中心nIsSetPayPwd数据异常")}}else{info(b.getText())}isPayPwd=true}function isCommonAuthentication(){var b=getStringValue("lUserId");var a=new CDO();a.setStringValue("strServiceName","UserService");a.setStringValue("strTransName","queryIdentity");a.setLongValue("lUserId",Number(b));raiseTrans(a,"callBackQueryIdentity")}function callBackQueryIdentity(cdoRequest,cdoResponse,ret){if(ret==undefined||ret==null){info("请求失败!");isPayPwd=true;return false}if(ret.nCode==0){if(cdoResponse.exists("nIdentityState")){var nIdentityState=cdoResponse.getIntegerValue("nIdentityState");if(nIdentityState==90||nIdentityState==100){if(state==1){eval(strCallbackData+"('"+state+"')")}else{_TTPopups.open2({content:"请先设置支付密码。",cancelBtn:"否",submitBtn:"是",closeCallBack:"TT_pay_pw"})}}else{if(nIdentityState==10){_TTPopups.open2({content:"请先进行实名认证。",cancelBtn:"否",submitBtn:"是",closeCallBack:"TT_pay_sm_1"})}else{if(nIdentityState==20){info("实名认证中，请耐心等待。")}else{if(nIdentityState==30){_TTPopups.open2({content:"实名认证失败，请重新认证。",cancelBtn:"否",submitBtn:"是",closeCallBack:"TT_pay_sm_2"})}}}}}else{info(ret.getText())}}else{info(ret.getText())}isPayPwd=true}function TT_pay_pw(a){if(a==1){openWindow("myCenter/securityCenter/payPwdSet.htm","设置支付密码","",0,"")}}function TT_pay_sm_1(a){if(a==1){openWindow("myCenter/securityCenter/accountIdCard.htm","实名认证","clearUser=1&nIdentityState=10",0,"")}}function TT_pay_sm_2(a){if(a==1){openWindow("myCenter/securityCenter/accountIdCard.htm","实名认证","clearUser=1&nIdentityState=30",0,"")}};